webpackJsonp([1],{NHnr:function(t,e,a){"use strict";function s(t){a("we4B")}function i(t){a("tR2c")}function l(t){a("s3X/")}Object.defineProperty(e,"__esModule",{value:!0});var r=a("1P6t"),u={name:"app"},n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"app"}},[a("router-view")],1)},c=[],o={render:n,staticRenderFns:c},d=o,_=a("/Xao"),f=s,h=_(u,d,!1,f,null,null),p=h.exports,m=a("zO6J"),k=a("aA9S"),v=a.n(k),L={name:"vueSku",props:{skuData:{type:Object,required:!0},options:{type:Object}},watch:{skuData:function(){this.updateValue(),this.initSku(),this.initStatus()}},data:function(){return{params:{},defaultParams:{},attrListName:"format_list",skuListName:"sku_sale_list",attrListKeyName:"name",attrListKeyId:"id",attrListValueName:"name",attrListValueId:"id",attrListValueEachKey:"format_val_list",attrListValue:[],skuListValue:[],skuListValueName:"format_val_name",skuListValueId:"format_val_id",skuName:"stock_price_list",splitStr:";",selectedSkuInfo:"",SKUResult:{}}},mounted:function(){v()(this.params,this.defaultParams,this.options)},methods:{isSelectAll:function(){var t=this,e=this.attrListValue.length,a=0,s=[];return this.attrListValue.forEach(function(e){var i=!1;e[t.attrListValueEachKey].forEach(function(e){!0===e.selected&&(s.push(e[t.attrListValueId]),i=!0)}),i&&a++}),a>=e&&(this.selectedSkuInfo=this.skuListValue.filter(function(e){return e[t.skuListValueId]===s.join(t.splitStr)})[0],console.warn(this.selectedSkuInfo,"选择的SKU信息为"),!0)},attrStatus:function(t){return{status:!t.disabled,"status disabled":t.disabled,selected:t.selected&&!t.disabled}},updateValue:function(){this.attrListValue=this.skuData[this.attrListName].map(function(t){return t.format_val_list.map(function(t){t.disabled=!1,t.selected=!1}),t}),this.skuListValue=this.skuData[this.skuListName]},initSku:function(){for(var t=this,e=this.getObjKeys(this.skuListValue),a=0;a<e.length;a++){var s;!function(a){var i=e[a],l=t.skuListValue.findIndex(function(e){return e[t.skuListValueId]===i}),r=l>-1?t.skuListValue[l][t.skuName]:{},u=i.split(t.splitStr);u.sort(function(t,e){return parseInt(t)-parseInt(e)}),s=t.combInArray(u);for(var n=0;n<s.length;n++)t.add2SKUResult(s[n],r);t.SKUResult[u.join(t.splitStr)]=r}(a)}console.log(this.SKUResult,"this.SKUResult")},initStatus:function(){var t=this;this.attrListValue.forEach(function(e,a){e[t.attrListValueEachKey].map(function(e,s){t.SKUResult[e[t.attrListValueId]]||(t.attrListValue[a][t.attrListValueEachKey][s].disabled=!0)})})},getObjKeys:function(t){if(t!==Object(t))throw new TypeError("Invalid object");var e=[];for(var a in t)t[a][this.skuListValueId]&&(e[e.length]=t[a][this.skuListValueId]);return e},combInArray:function(t){if(!t||!t.length)return[];for(var e=t.length,a=[],s=1;s<e;s++)for(var i=this.getCombFlags(e,s);i.length;){for(var l=i.shift(),r=[],u=0;u<e;u++)l[u]&&r.push(t[u]);a.push(r)}return a},getCombFlags:function(t,e){if(!e||e<1)return[];for(var a,s=[],i=[],l=!0,r=0;r<t;r++)i[r]=r<e?1:0;for(s.push(i.concat());l;){a=0;for(var u=0;u<t-1;u++){if(1===i[u]&&0===i[u+1]){for(var n=0;n<u;n++)i[n]=n<a?1:0;i[u]=0,i[u+1]=1;var c=i.concat();s.push(c),-1===c.slice(-e).join("").indexOf("0")&&(l=!1);break}1===i[u]&&a++}}return s},add2SKUResult:function(t,e){var a=t.join(this.splitStr);this.SKUResult[a]||(this.SKUResult[a]={})},selectClick:function(t,e,a){var s=this;if(t.disabled)return!1;this.attrListValue[e][this.attrListValueEachKey][a].selected=!t.selected,this.attrListValue[e][this.attrListValueEachKey]=this.attrListValue[e][this.attrListValueEachKey].map(function(e){return t[s.attrListValueId]!==e[s.attrListValueId]&&(e.selected=!1),e}),this.isSelectAll();var i=this.getSelected();if(i.length){var l=[];i.forEach(function(t){l.push(+t[s.attrListKeyId])}),l.sort(function(t,e){return parseInt(t)-parseInt(e)}),this.attrListValue.forEach(function(t,e){t[s.attrListValueEachKey].forEach(function(a,i){if(!a.selected){var r=[];t[s.attrListValueEachKey].forEach(function(t){t.selected&&r.push(t)});var u=[];if(r.length)for(var n=+r[0][s.attrListKeyId],c=0;c<l.length;c++)l[c]!==n&&u.push(l[c]);else u=l.concat();u=u.concat(+a[s.attrListKeyId]),u.sort(function(t,e){return parseInt(t)-parseInt(e)}),s.SKUResult[u.join(s.splitStr)]?s.attrListValue[e][s.attrListValueEachKey][i].disabled=!1:(s.attrListValue[e][s.attrListValueEachKey][i].disabled=!0,s.attrListValue[e][s.attrListValueEachKey][i].selected=!1)}})})}else this.attrListValue.forEach(function(t,e){t[s.attrListValueEachKey].forEach(function(t,a){s.SKUResult[t[s.attrListValueId]]?s.attrListValue[e][s.attrListValueEachKey][a].disabled=!1:(s.attrListValue[e][s.attrListValueEachKey][a].disabled=!0,s.attrListValue[e][s.attrListValueEachKey][a].selected=!1)})})},getSelected:function(){var t=this,e=[];return this.attrListValue.forEach(function(a){a[t.attrListValueEachKey].forEach(function(t){!0===t.selected&&e.push(t)})}),e}}},V=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"vue-sku"},t._l(t.attrListValue,function(e,s){return a("div",{key:e.key,staticClass:"attrWrap"},[a("h1",{staticClass:"attrTitle"},[t._v(t._s(e[t.attrListKeyName]))]),t._v(" "),a("div",{staticClass:"attrValue"},t._l(e[t.attrListValueEachKey],function(e,i){return a("input",{key:e.key,class:t.attrStatus(e),attrs:{type:"button","data-attrid":e[t.attrListValueId],disabled:e.disabled,value:e[t.attrListValueName]},on:{click:function(a){t.selectClick(e,s,i)}}})}))])}))},y=[],K={render:V,staticRenderFns:y},S=K,b=a("/Xao"),E=i,I=b(L,S,!1,E,"data-v-4a1df416",null),g=I.exports,R={format_list:[{id:"1",name:"机身颜色",format_val_list:[{id:"110",name:"银色"},{id:"111",name:"黄色"},{id:"112",name:"黑色"},{id:"113",name:"玫瑰金"}]},{id:"2",name:"套餐类型",format_val_list:[{id:"210",name:"官方标配"},{id:"211",name:"套餐二"}]},{id:"3",name:"机身内存",format_val_list:[{id:"310",name:"16GB"},{id:"311",name:"64GB"},{id:"312",name:"128GB"}]},{id:"4",name:"版本类型",format_val_list:[{id:"410",name:"港澳台"},{id:"411",name:"美国"},{id:"412",name:"欧洲"},{id:"413",name:"日本"},{id:"414",name:"中国大陆"}]}],sku_sale_list:[{sku_sale_id:"66",format_val_id:"110;210;311;414",sale_unit:"0",adult_selected:"1",child_selected:"0",baby_selected:"0",is_date:"1",sku_id:"870",is_control:"0",is_digital_stock:"1",sale_id:"34",format_val_name:"销售写真",stock_price_list:[{adult_price:"589.00",child_price:"579.00",date:"2017-11-17",stock:"14"},{adult_price:"589.00",child_price:"579.00",date:"2017-11-18",stock:"5"}]},{sku_sale_id:"67",format_val_id:"111;211;310;414",sale_unit:"0",adult_selected:"1",child_selected:"0",baby_selected:"0",is_date:"1",sku_id:"870",is_control:"0",is_digital_stock:"1",sale_id:"34",format_val_name:"销售写真",stock_price_list:[{adult_price:"5189.00",child_price:"5279.00",date:"2017-11-17",stock:"14"},{adult_price:"5829.00",child_price:"579.00",date:"2017-11-18",stock:"5"}]},{sku_sale_id:"68",format_val_id:"112;210;312;413",sale_unit:"0",adult_selected:"1",child_selected:"0",baby_selected:"0",is_date:"1",sku_id:"870",is_control:"0",is_digital_stock:"1",sale_id:"34",format_val_name:"销售写真",stock_price_list:[{adult_price:"5849.00",child_price:"5.00",date:"2017-11-17",stock:"1"},{adult_price:"589.00",child_price:"579.00",date:"2017-11-18",stock:"2"}]},{sku_sale_id:"69",format_val_id:"113;210;311;412",sale_unit:"0",adult_selected:"1",child_selected:"0",baby_selected:"0",is_date:"1",sku_id:"870",is_control:"0",is_digital_stock:"1",sale_id:"34",format_val_name:"销售写真",stock_price_list:[{adult_price:"581.00",child_price:"572.00",date:"2017-11-12",stock:"10"},{adult_price:"589.00",child_price:"579.00",date:"2017-11-13",stock:"9"}]}],error_code:"0000",error_msg:"OK"},N=R,U={name:"HelloWorld",data:function(){return{skuData:{}}},components:{vueSku:g},mounted:function(){this.getSku()},methods:{getSku:function(){var t=this;setTimeout(function(){t.skuData={format_list:N.format_list,sku_sale_list:N.sku_sale_list}},2e3)},pay:function(){this.$refs.sku.isSelectAll()||alert("请选择商品")},format:function(){console.dir(this.skuData)}}},j=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"hello"},[a("vue-sku",{ref:"sku",attrs:{skuData:t.skuData}}),t._v(" "),a("p",{staticStyle:{padding:"20px"}}),t._v(" "),a("input",{attrs:{type:"button",value:"去支付"},on:{click:t.pay}}),t._v(" "),a("input",{attrs:{type:"button",value:"console SKU数据格式"},on:{click:t.format}})],1)},w=[],C={render:j,staticRenderFns:w},D=C,O=a("/Xao"),A=l,x=O(U,D,!1,A,"data-v-caecac38",null),B=x.exports;r.a.use(m.a);var F=new m.a({routes:[{path:"/",name:"HelloWorld",component:B}]});r.a.config.productionTip=!1,new r.a({el:"#app",router:F,template:"<App/>",components:{App:p}})},"s3X/":function(t,e){},tR2c:function(t,e){},we4B:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.a9a38735bc5f71e2b8cf.js.map